import { createHistory } from "@@/core/history";
import qiankunRender, { contextOptsStack } from "./lifecycles";
export function render(oldRender) {
  return qiankunRender().then(oldRender);
}
export function modifyClientRenderOpts(memo) {
  const clientRenderOpts = contextOptsStack.shift();
  const { basename, historyType } = memo;
  const newBasename = clientRenderOpts?.basename ?? basename;
  const newHistoryType = clientRenderOpts?.historyType || historyType;
  if (newHistoryType !== historyType || newBasename !== basename) {
    clientRenderOpts.history = createHistory({
      type: newHistoryType,
      basename: newBasename,
      ...clientRenderOpts.historyOpts
    });
  }
  return {
    ...memo,
    ...clientRenderOpts,
    basename: newBasename,
    historyType: newHistoryType
  };
}
